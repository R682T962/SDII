Version 4
SHEET 1 3736 680
WIRE 3456 -208 3456 -240
WIRE 1808 -144 1568 -144
WIRE -64 -112 -112 -112
WIRE 48 -112 0 -112
WIRE 144 -112 48 -112
WIRE 256 -112 144 -112
WIRE 3072 -96 3072 -112
WIRE 3072 -96 2976 -96
WIRE 48 -80 48 -112
WIRE 2224 -80 2224 -96
WIRE 2464 -80 2224 -80
WIRE 3072 -80 3072 -96
WIRE 3168 -80 3072 -80
WIRE 3456 -80 3456 -128
WIRE 144 -64 144 -112
WIRE 2688 -64 2528 -64
WIRE 2800 -64 2688 -64
WIRE 1568 -48 1568 -144
WIRE 1616 -48 1568 -48
WIRE 2272 -48 2224 -48
WIRE 2384 -48 2352 -48
WIRE 2464 -48 2384 -48
WIRE 3072 -48 3072 -80
WIRE 1808 -32 1808 -144
WIRE 1808 -32 1680 -32
WIRE 1856 -32 1808 -32
WIRE 1104 -16 1072 -16
WIRE 1216 -16 1184 -16
WIRE 1248 -16 1216 -16
WIRE 1376 -16 1328 -16
WIRE 1408 -16 1376 -16
WIRE 1552 -16 1488 -16
WIRE 1616 -16 1552 -16
WIRE 1216 0 1216 -16
WIRE 2976 0 2976 -96
WIRE 3408 0 3360 0
WIRE -224 16 -224 0
WIRE 48 32 48 0
WIRE 144 32 144 0
WIRE 144 32 48 32
WIRE 304 32 144 32
WIRE 608 32 304 32
WIRE 640 32 640 -16
WIRE 640 32 608 32
WIRE 672 32 640 32
WIRE 1552 32 1552 -16
WIRE 2976 32 2976 0
WIRE 3024 32 2976 32
WIRE 3168 32 3168 -80
WIRE 3360 32 3360 0
WIRE 3360 32 3168 32
WIRE 672 48 672 32
WIRE 1648 80 1648 0
WIRE 336 96 272 96
WIRE 608 96 608 32
WIRE 608 96 560 96
WIRE 1216 96 1216 64
WIRE -224 112 -224 96
WIRE -224 112 -288 112
WIRE 2384 112 2384 -48
WIRE 2480 112 2384 112
WIRE 2688 112 2688 -64
WIRE 2688 112 2560 112
WIRE -224 128 -224 112
WIRE 256 160 256 -112
WIRE 336 160 256 160
WIRE 592 160 560 160
WIRE 672 160 672 128
WIRE 672 160 592 160
WIRE 1552 160 1552 96
WIRE 672 192 672 160
WIRE 336 224 176 224
WIRE 592 224 592 160
WIRE 592 224 560 224
WIRE 1376 224 1376 -16
WIRE 1552 224 1376 224
WIRE 1808 224 1808 -32
WIRE 1808 224 1616 224
WIRE -224 288 -224 208
WIRE 304 288 304 32
WIRE 336 288 304 288
WIRE 576 288 560 288
WIRE 672 288 672 256
WIRE 672 288 640 288
WIRE 272 416 272 96
WIRE 448 416 272 416
WIRE 672 416 672 288
WIRE 672 416 448 416
WIRE 448 448 448 416
FLAG -288 112 0
FLAG -640 240 0
FLAG -224 0 Vcc
FLAG 640 -16 Vcc
FLAG -640 160 Vtrig
FLAG -112 -112 Vtrig
FLAG -224 288 -Vcc
FLAG 448 448 0
FLAG 176 224 PWM
FLAG 1072 -16 PWM
FLAG 1552 160 0
FLAG 1648 -64 Vcc
FLAG 1216 96 0
FLAG 1856 -32 avg
FLAG 2224 -48 avg
FLAG 2224 -96 Vref
FLAG 2032 176 Vref
FLAG 2496 -96 Vcc
FLAG 2800 -64 comparator
FLAG 2032 256 0
FLAG 3072 -192 Vcc
FLAG 3456 -240 Vcc
FLAG 2976 0 comparator
FLAG 1648 80 -Vcc
FLAG 3072 48 -Vcc
FLAG 3456 16 -Vcc
FLAG 2496 -32 0
SYMBOL voltage -224 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL voltage -224 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL voltage -640 144 R0
WINDOW 3 -127 -79 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 5 0 0.01m 0.01m 6m 12m)
SYMATTR InstName V3
SYMBOL Misc\\NE555 448 192 R0
SYMATTR InstName U1
SYMBOL cap 640 272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL cap 656 192 R0
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL res 656 32 R0
SYMATTR InstName R1
SYMATTR Value 1Meg
SYMBOL res 32 -96 R0
SYMATTR InstName R5
SYMATTR Value 4k
SYMBOL cap 0 -128 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL diode 128 -64 R0
SYMATTR InstName D1
SYMBOL res 1344 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 1504 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL cap 1568 96 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 1�
SYMBOL OpAmps\\LT1638 1648 -96 R0
SYMATTR InstName U2
SYMBOL cap 1616 208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 1�
SYMBOL res 1200 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL cap 1200 0 R0
SYMATTR InstName C6
SYMATTR Value 10n
SYMBOL OpAmps\\LT1638 2496 -128 R0
WINDOW 3 32 133 Left 2
SYMATTR InstName U3
SYMBOL res 2368 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 2576 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 12k
SYMBOL voltage 2032 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.45
SYMBOL pmos 3024 -48 R0
SYMATTR InstName M1
SYMBOL pmos 3408 -80 R0
SYMATTR InstName M2
SYMBOL res 3056 -208 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL res 3440 -224 R0
SYMATTR InstName R9
SYMATTR Value 9
TEXT -776 -16 Left 2 !.tran 0 2 1

Version 4
SHEET 1 1264 680
WIRE -1472 -16 -1504 -16
WIRE -1584 48 -1584 -16
WIRE -1584 192 -1584 128
WIRE -1776 272 -1952 272
WIRE -1632 272 -1696 272
WIRE -1616 272 -1632 272
WIRE -1952 288 -1952 272
WIRE -1584 384 -1584 288
WIRE -1952 400 -1952 368
WIRE -1680 400 -1952 400
WIRE -1680 448 -1680 400
FLAG -1680 448 0
FLAG -1472 -16 0
FLAG -1584 384 0
SYMBOL voltage -1952 272 R0
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Compacto_input_0or5
SYMATTR Value 5
SYMBOL nmos -1632 192 R0
SYMATTR InstName M2
SYMATTR Value Si7336ADP
SYMBOL res -1680 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 220
SYMBOL voltage -1600 -16 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vcc
SYMATTR Value 5
SYMBOL res -1600 32 R0
SYMATTR InstName Pull_up_resistor
SYMATTR Value 5
TEXT -2104 -168 Left 2 !.tran 10

Version 4
SHEET 1 3736 680
WIRE 3376 -240 3376 -304
WIRE 1808 -144 1568 -144
WIRE 3376 -128 3376 -160
WIRE -64 -112 -112 -112
WIRE 48 -112 0 -112
WIRE 144 -112 48 -112
WIRE 256 -112 144 -112
WIRE 48 -80 48 -112
WIRE 2224 -80 2224 -96
WIRE 2464 -80 2224 -80
WIRE 144 -64 144 -112
WIRE 2688 -64 2528 -64
WIRE 2800 -64 2688 -64
WIRE 1568 -48 1568 -144
WIRE 1616 -48 1568 -48
WIRE 2272 -48 2224 -48
WIRE 2384 -48 2352 -48
WIRE 2464 -48 2384 -48
WIRE 3200 -48 3120 -48
WIRE 3312 -48 3280 -48
WIRE 3328 -48 3312 -48
WIRE 1808 -32 1808 -144
WIRE 1808 -32 1680 -32
WIRE 1856 -32 1808 -32
WIRE 1104 -16 1072 -16
WIRE 1216 -16 1184 -16
WIRE 1248 -16 1216 -16
WIRE 1376 -16 1328 -16
WIRE 1408 -16 1376 -16
WIRE 1552 -16 1488 -16
WIRE 1616 -16 1552 -16
WIRE 3312 -16 3312 -48
WIRE 1216 0 1216 -16
WIRE -224 16 -224 0
WIRE 48 32 48 0
WIRE 144 32 144 0
WIRE 144 32 48 32
WIRE 304 32 144 32
WIRE 608 32 304 32
WIRE 640 32 640 -16
WIRE 640 32 608 32
WIRE 672 32 640 32
WIRE 1552 32 1552 -16
WIRE 672 48 672 32
WIRE 1648 80 1648 0
WIRE 3312 80 3312 64
WIRE 3376 80 3376 -32
WIRE 3376 80 3312 80
WIRE 336 96 272 96
WIRE 608 96 608 32
WIRE 608 96 560 96
WIRE 1216 96 1216 64
WIRE -224 112 -224 96
WIRE -224 112 -288 112
WIRE 2384 112 2384 -48
WIRE 2480 112 2384 112
WIRE 2688 112 2688 -64
WIRE 2688 112 2560 112
WIRE -224 128 -224 112
WIRE 3376 128 3376 80
WIRE 256 160 256 -112
WIRE 336 160 256 160
WIRE 592 160 560 160
WIRE 672 160 672 128
WIRE 672 160 592 160
WIRE 1552 160 1552 96
WIRE 672 192 672 160
WIRE 336 224 176 224
WIRE 592 224 592 160
WIRE 592 224 560 224
WIRE 1376 224 1376 -16
WIRE 1552 224 1376 224
WIRE 1808 224 1808 -32
WIRE 1808 224 1616 224
WIRE 304 288 304 32
WIRE 336 288 304 288
WIRE 576 288 560 288
WIRE 672 288 672 256
WIRE 672 288 640 288
WIRE -224 336 -224 288
WIRE 272 416 272 96
WIRE 448 416 272 416
WIRE 672 416 672 288
WIRE 672 416 448 416
WIRE 448 448 448 416
FLAG -288 112 0
FLAG -640 240 0
FLAG -224 0 Vcc
FLAG 640 -16 Vcc
FLAG -640 160 Vtrig
FLAG -112 -112 Vtrig
FLAG -224 288 -Vcc
FLAG 448 448 0
FLAG 176 224 PWM
FLAG 1072 -16 PWM
FLAG 1552 160 0
FLAG 1648 -64 Vcc
FLAG 1216 96 0
FLAG 1856 -32 avg
FLAG 2224 -48 avg
FLAG 2224 -96 Vref
FLAG 2032 176 Vref
FLAG 2496 -96 Vcc
FLAG 2800 -64 comparator
FLAG 2032 256 0
FLAG 3120 -48 comparator
FLAG 1648 80 -Vcc
FLAG 2496 -32 0
FLAG -224 336 0
FLAG 3376 -304 Vcc
FLAG 3376 128 0
SYMBOL voltage -224 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL voltage -224 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL voltage -640 144 R0
WINDOW 3 -127 -79 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 5 0 0.01m 0.01m 6m 12m)
SYMATTR InstName V3
SYMBOL Misc\\NE555 448 192 R0
SYMATTR InstName U1
SYMBOL cap 640 272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL cap 656 192 R0
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL res 656 32 R0
SYMATTR InstName R1
SYMATTR Value 1Meg
SYMBOL res 32 -96 R0
SYMATTR InstName R5
SYMATTR Value 4k
SYMBOL cap 0 -128 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL diode 128 -64 R0
SYMATTR InstName D1
SYMBOL res 1344 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 1504 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL cap 1568 96 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 1�
SYMBOL OpAmps\\LT1638 1648 -96 R0
SYMATTR InstName U2
SYMBOL cap 1616 208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 1�
SYMBOL res 1200 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL cap 1200 0 R0
SYMATTR InstName C6
SYMATTR Value 10n
SYMBOL OpAmps\\LT1638 2496 -128 R0
WINDOW 3 32 133 Left 2
SYMATTR InstName U3
SYMBOL res 2368 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 2576 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 12k
SYMBOL voltage 2032 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.45
SYMBOL nmos 3328 -128 R0
SYMATTR InstName M1
SYMBOL res 3296 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res 3328 80 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 3360 -256 R0
SYMATTR InstName R10
SYMATTR Value 1k
TEXT -776 -16 Left 2 !.tran 0 2 1
